#!/bin/sh
exec 2>&1

# Source env vars written by bootstrap (API keys, etc.)
# Daemon will restart this service when env vars change
[ -f ~/.iterate/.env ] && set -a && . ~/.iterate/.env && set +a

SCRIPT_DIR="$(cd "$(dirname "$0")" && pwd)"
PORT=$(node -p "require('$SCRIPT_DIR/metadata.json').port")

exec opencode serve --port "$PORT" --hostname 0.0.0.0 --log-level DEBUG
