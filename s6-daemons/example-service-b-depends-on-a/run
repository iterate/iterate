#!/bin/sh
exec 2>&1
cd "$ITERATE_REPO/scripts"

# Health checker in background
"$ITERATE_REPO/scripts/s6-healthcheck-notify.sh" http://localhost:3002/health &

# Example service B: depends on service A
# Health check will fail until service A is ready (checks A's /ping endpoint)
exec node --experimental-strip-types test-daemon.ts \
  --name service-b \
  --port 3002 \
  --startup-delay 0 \
  --upstream http://localhost:3001/ping
